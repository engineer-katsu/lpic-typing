<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LPIC Penguin Dash</title>
    <style>
        :root {
            --bg-dark: #0d1117;
            --ice-blue: #a5f3fc;
            --term-green: #00ff41;
            --text-white: #ffffff;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-white);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* ã‚²ãƒ¼ãƒ ç”»é¢ã®ã‚³ãƒ³ãƒ†ãƒŠ */
        #game-stage {
            position: relative;
            width: 100vw;
            height: 400px;
            background: linear-gradient(to bottom, #001f3f 0%, #0074d9 70%, var(--ice-blue) 70%, #ffffff 100%);
            border-bottom: 5px solid #ddd;
            overflow: hidden;
            margin-top: 20px;
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º */
        #hud {
            width: 90%;
            max-width: 800px;
            display: flex;
            justify-content: space-between;
            padding: 15px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        /* æµã‚Œã‚‹æ–‡å­—ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .word-box {
            position: absolute;
            white-space: nowrap;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            color: var(--text-white);
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            transition: transform 0.1s linear;
        }

        .word-box .current { color: var(--term-green); text-decoration: underline; }
        .word-box .desc { font-size: 0.8rem; display: block; color: #aaa; }

        /* ãƒšãƒ³ã‚®ãƒ³ã®ç°¡æ˜“è¡¨ç¤ºï¼ˆç”»åƒãŒãªã„å ´åˆç”¨ï¼‰ */
        .penguin-icon {
            position: absolute;
            bottom: 25%;
            left: 50px;
            font-size: 3rem;
            z-index: 10;
        }

        /* çµæœç”»é¢ */
        #result-screen {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            padding: 40px;
            border: 2px solid var(--term-green);
            text-align: center;
            z-index: 100;
        }

        #start-btn {
            padding: 15px 30px;
            font-size: 1.5rem;
            background: var(--term-green);
            color: black;
            border: none;
            cursor: pointer;
            margin-top: 100px;
        }
    </style>
</head>
<body>

<div id="hud">
    <div>Time: <span id="timer">60</span>s</div>
    <div>Score: <span id="score">0</span></div>
</div>

<div id="game-stage">
    <div class="penguin-icon" id="player">ğŸ§</div>
    <button id="start-btn">ã‚²ãƒ¼ãƒ é–‹å§‹ (Enter)</button>
</div>

<div id="result-screen">
    <h2>çµæœç™ºè¡¨</h2>
    <p id="final-score"></p>
    <p id="rank-msg"></p>
    <button onclick="location.reload()">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦</button>
</div>

<script>
    const questions = [
        { cmd: "ls -la", desc: "éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚€å…¨è©³ç´°è¡¨ç¤º" },
        { cmd: "ls -ltr", desc: "å¤ã„é †ã«è©³ç´°è¡¨ç¤º" },
        { cmd: "cp -rp src/ dest/", desc: "å±æ€§ä¿æŒã—ã¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚³ãƒ”ãƒ¼" },
        { cmd: "rm -rf /tmp/old", desc: "å¼·åˆ¶ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤" },
        { cmd: "mkdir -p /a/b", desc: "éšå±¤ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ" },
        { cmd: "chmod 755 script", desc: "å®Ÿè¡Œæ¨©é™ä»˜ä¸" },
        { cmd: "chown root:root file", desc: "æ‰€æœ‰è€…å¤‰æ›´" },
        { cmd: "grep -i 'error' log", desc: "å¤§æ–‡å­—å°æ–‡å­—ç„¡è¦–æ¤œç´¢" },
        { cmd: "systemctl start sshd", desc: "SSHèµ·å‹•" },
        { cmd: "df -h", desc: "ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡è¡¨ç¤º" },
        { cmd: "ip addr show", desc: "IPç¢ºèª" },
        { cmd: "tail -f /var/log", desc: "ãƒ­ã‚°ç›£è¦–" }
    ];

    let score = 0;
    let timeLeft = 60;
    let gameActive = false;
    let activeWords = [];
    let gameSpeed = 2; // æ–‡å­—ã®æµã‚Œã‚‹é€Ÿåº¦
    const stage = document.getElementById('game-stage');

    class Word {
        constructor() {
            const q = questions[Math.floor(Math.random() * questions.length)];
            this.fullText = q.cmd;
            this.desc = q.desc;
            this.typedIndex = 0;
            this.x = window.innerWidth;
            this.y = Math.random() * 200 + 50; // å‡ºç¾ã™ã‚‹é«˜ã•

            this.element = document.createElement('div');
            this.element.className = 'word-box';
            this.updateElement();
            stage.appendChild(this.element);
        }

        updateElement() {
            const typed = `<span class="current">${this.fullText.substring(0, this.typedIndex)}</span>`;
            const untyped = this.fullText.substring(this.typedIndex);
            this.element.innerHTML = `${typed}${untyped}<span class="desc">${this.desc}</span>`;
            this.element.style.left = this.x + 'px';
            this.element.style.top = this.y + 'px';
        }

        move() {
            this.x -= gameSpeed;
            this.element.style.left = this.x + 'px';
        }
    }

    function startGame() {
        gameActive = true;
        document.getElementById('start-btn').style.display = 'none';
        
        // 1.5ç§’ã”ã¨ã«æ–°ã—ã„ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
        const spawner = setInterval(() => {
            if (!gameActive) clearInterval(spawner);
            activeWords.push(new Word());
        }, 1500);

        // ã‚¿ã‚¤ãƒãƒ¼
        const timerInt = setInterval(() => {
            timeLeft--;
            document.getElementById('timer').innerText = timeLeft;
            if (timeLeft <= 0) {
                gameActive = false;
                clearInterval(timerInt);
                showResult();
            }
        }, 1000);

        gameLoop();
    }

    function gameLoop() {
        if (!gameActive) return;

        activeWords.forEach((word, index) => {
            word.move();
            // ç”»é¢å¤–ã«å‡ºãŸã‚‰ãƒŸã‚¹
            if (word.x < -300) {
                word.element.remove();
                activeWords.splice(index, 1);
            }
        });

        requestAnimationFrame(gameLoop);
    }

    window.addEventListener('keydown', (e) => {
        if (!gameActive) {
            if (e.key === 'Enter') startGame();
            return;
        }

        // ç¾åœ¨ç”»é¢ã«ã‚ã‚‹ä¸­ã§ä¸€ç•ªå·¦ã«ã‚ã‚‹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã™ã‚‹
        if (activeWords.length === 0) return;
        
        // æœ€ã‚‚å·¦ã«ã‚ã‚‹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—
        let targetWord = activeWords[0];

        if (e.key === targetWord.fullText[targetWord.typedIndex]) {
            targetWord.typedIndex++;
            score += 10;
            document.getElementById('score').innerText = score;
            
            if (targetWord.typedIndex >= targetWord.fullText.length) {
                targetWord.element.style.background = "var(--term-green)";
                setTimeout(() => {
                    targetWord.element.remove();
                }, 100);
                activeWords.shift();
                score += 100; // æ‰“ã¡åˆ‡ã‚Šãƒœãƒ¼ãƒŠã‚¹
            } else {
                targetWord.updateElement();
            }
        }
    });

    function showResult() {
        document.getElementById('result-screen').style.display = 'block';
        document.getElementById('final-score').innerText = `ã‚¹ã‚³ã‚¢: ${score}ç‚¹`;
        let rank = "LPIC ç·´ç¿’ç”Ÿç´š";
        if (score > 1000) rank = "rootæ¨©é™ç´š";
        else if (score > 500) rank = "ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ç´š";
        document.getElementById('rank-msg').innerText = `ç§°å·: ${rank}`;
    }

</script>
</body>
</html>
